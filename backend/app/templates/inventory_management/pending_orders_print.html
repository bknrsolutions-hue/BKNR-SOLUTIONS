<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pending Orders â€“ Print</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
@page{
  size: A4 landscape;
  margin: 12mm;
}

body{
  font-family: Arial, Helvetica, sans-serif;
  font-size: 11px;
  margin: 0;
  background: #fff;
  color: #000;
}

/* HEADER */
.print-header{
  text-align: center;
  margin-bottom: 12px;
}
.print-header h2{
  margin: 0;
  font-size: 18px;
  font-weight: 800;
}
.print-header p{
  margin: 2px 0 0;
  font-size: 11px;
}

/* TABLE */
table{
  width: 100%;
  border-collapse: collapse;
}

th, td{
  border: 1px solid #000;
  padding: 6px;
  text-align: center;
  vertical-align: middle;
}

th{
  background: #f0f0f0;
  font-weight: 800;
  text-transform: uppercase;
}

/* MERGED PO CELLS */
.po-cell{
  font-weight: 700;
  background: #fafafa;
}

/* SUB TOTAL */
.subtotal-row td{
  font-weight: 800;
  background: #eaeaea;
}

/* HIDE SCREEN ELEMENTS IF ANY */
.no-print{
  display: none !important;
}
</style>
</head>

<body>

<div class="print-header">
  <h2>PENDING ORDERS REPORT</h2>
  <p>BKNR ERP SYSTEM</p>
</div>

<table>
<thead>
<tr>
  <th>PO</th>
  <th>Buyer</th>
  <th>Agent</th>
  <th>Country</th>
  <th>Shipment</th>
  <th>Brand</th>
  <th>Packing</th>
  <th>Freezer</th>
  <th>Count %</th>
  <th>Weight %</th>
  <th>Variety</th>
  <th>Grade</th>
  <th>MC</th>
</tr>
</thead>

<tbody>

{% for po, rows in po_groups.items() %}
  {% set ns = namespace(total_mc=0) %}
  {% for r in rows %}
    {% set ns.total_mc = ns.total_mc + (r.no_of_mc or 0) %}
    <tr>
      {% if loop.first %}
        <td class="po-cell" rowspan="{{ rows|length }}">{{ r.po_number }}</td>
        <td class="po-cell" rowspan="{{ rows|length }}">{{ r.buyer }}</td>
        <td class="po-cell" rowspan="{{ rows|length }}">{{ r.agent_name }}</td>
        <td class="po-cell" rowspan="{{ rows|length }}">{{ r.country }}</td>
        <td class="po-cell" rowspan="{{ rows|length }}">{{ r.shipment_date }}</td>
      {% endif %}
      <td>{{ r.brand }}</td>
      <td>{{ r.packing_style }}</td>
      <td>{{ r.freezer }}</td>
      <td>{{ r.count_glaze }}</td>
      <td>{{ r.weight_glaze }}</td>
      <td>{{ r.variety }}</td>
      <td>{{ r.grade }}</td>
      <td style="font-weight:700">{{ r.no_of_mc }}</td>
    </tr>
  {% endfor %}

  <tr class="subtotal-row">
    <td colspan="12" style="text-align:right;">TOTAL MC</td>
    <td>{{ ns.total_mc }}</td>
  </tr>

{% endfor %}

</tbody>
</table>

<script>
{% if print_mode %}
  window.onload = function(){
    window.print();
  }
{% endif %}
</script>

</body>
</html>
