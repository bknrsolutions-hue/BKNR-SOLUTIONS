<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Face Attendance</title>

<style>
body{
    background:#eef6ff;
    font-family:Arial;
    margin:0;
}
header{
    background:#003c74;
    color:#fff;
    font-size:22px;
    font-weight:bold;
    text-align:center;
    padding:12px;
}

.container{
    max-width:600px;
    background:#fff;
    margin:20px auto;
    padding:20px;
    border-radius:12px;
    box-shadow:0 0 20px rgba(0,0,0,0.1);
    text-align:center;
}

#camera{
    width:100%;
    max-width:350px;
    border:4px solid #004d99;
    border-radius:12px;
}

button{
    background:#0074ff;
    color:white;
    border:none;
    padding:14px;
    font-size:18px;
    width:90%;
    border-radius:10px;
    margin-top:18px;
    cursor:pointer;
    font-weight:bold;
}
button:hover{background:#005fcc}

#result_box{
    margin-top:20px;
    font-size:20px;
    font-weight:bold;
    color:green;
}
.error{color:#d10000!important;font-weight:bold;}
</style>
</head>

<body>

<header>FACE ATTENDANCE SYSTEM</header>

<div class="container">

    <video id="camera" autoplay playsinline></video>

    <button onclick="capture()">üì∏ Mark Attendance</button>

    <div id="result_box"></div>
</div>

<script>
// Camera start
navigator.mediaDevices.getUserMedia({video:true})
.then(s=>camera.srcObject=s);

// Capture ‚Üí Send ‚Üí Mark Attendance
async function capture(){

    let c=document.createElement("canvas");
    c.width=camera.videoWidth;c.height=camera.videoHeight;
    c.getContext("2d").drawImage(camera,0,0,c.width,c.height);
    let img=c.toDataURL("image/jpeg");

    let r=await fetch("/attendance/face/mark",{
        method:"POST",headers:{"Content-Type":"application/json"},
        body:JSON.stringify({image:img})
    });
    
    let j=await r.json();

    if(j.status=="success"){
        result_box.innerHTML =
        `‚úî Attendance <b>${j.punch}</b><br>`+
        `<span style="font-size:22px;color:#003b7a">${j.employee.name}</span><br>`+
        `<small>ID: ${j.employee.id} | Type: ${j.employee.type}</small>`;
    }
    else{
        result_box.innerHTML=`<span class="error">‚ùå ${j.message}</span>`;
    }
}
</script>
</body>
</html>
